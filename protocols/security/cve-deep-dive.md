# Protocol: CVE Deep Dive

## When to Use
When a specific CVE requires detailed investigation â€” triggered by a critical finding in a daily briefing, a team request, or an active exploitation report.

## Prerequisites
- Skills: `cve-lookup`, `rss-analyzer`, `report-generator`, `vault-writer`
- Templates: `templates/security/cve-report.md`

## Steps

### 1. Fetch CVE Details
```bash
python3 skills/security/cve-lookup/scripts/query-nvd.py --cve CVE-XXXX-XXXXX --format detailed
```

### 2. Search for Related Coverage
Search RSS feeds for mentions of the CVE:
```bash
python3 skills/security/rss-analyzer/scripts/fetch-feeds.py --since 30d | \
  python3 scripts/analyze-feed.py | \
  jq '[.[] | select(.title | test("CVE-XXXX-XXXXX"; "i"))]'
```

### 3. Research Context
Using available search tools, investigate:
- Is this being actively exploited in the wild?
- Are there proof-of-concept exploits available?
- What products/versions are affected?
- Are patches available? What versions fix the issue?
- What is the attack vector and complexity?

### 4. Assess Impact
Determine relevance to our environment:
- Do we run affected software?
- What is the exposure level (internet-facing vs internal)?
- What data or systems are at risk?
- Is there a workaround if patching isn't immediate?

### 5. Generate Report
```bash
python3 skills/shared/report-generator/scripts/render-template.py --template templates/security/cve-report.md --data /tmp/cve-analysis.json
```

### 6. Recommendations
Provide clear, actionable recommendations:
- Immediate actions (if critical/actively exploited)
- Patching timeline recommendation
- Temporary mitigations
- Detection rules or indicators of compromise

### 7. Save and Deliver
Save to `Security/CVEs/CVE-XXXX-XXXXX.md` and deliver to requester/team.

## Expected Output
Detailed CVE analysis report with context, impact assessment, and actionable recommendations.

## Error Handling
- **CVE not in NVD yet:** Search by keyword, check vendor advisories directly
- **Limited public information:** Note gaps, set follow-up reminder for re-analysis
